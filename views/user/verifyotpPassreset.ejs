<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wearify | OTP Verification</title>
    <link rel="stylesheet" href="/css/otp.css">
</head>
<body class="otp-page">

    <header class="otp-header">
        <div class="logo"><strong>Wearify</strong></div>
    </header>

    <main class="otp-container">
        <div class="otp-card">
            <h1>OTP Verification</h1>
            <p class="instruction">Enter the OTP sent to your registered email/phone number.</p>
            
            <form action="/forgot-otp" method="POST">
                <div class="otp-input-group">
                    <% for(let i=0; i<6; i++) { %>
                        <input type="text" name="otp" maxlength="1" class="otp-box" required autofocus>
                    <% } %>
                </div>

                <button type="submit" class="btn-verify">Verify OTP</button>
            </form>

            <div class="otp-footer">
               <a href="/resend-otp"><p class="resend-text">Resend OTP (<span id="timer">60</span>s)</p></a> 
                <p class="security-note">For your security, this OTP is valid for 5 minutes.</p>
            </div>
        </div>
    </main>

    <footer class="admin-footer">
        Wearify Admin Â©
    </footer>

    <script>
        // Simple auto-focus shift logic
        const inputs = document.querySelectorAll('.otp-box');
        inputs.forEach((input, index) => {
            input.addEventListener('input', () => {
                if (input.value && index < inputs.length - 1) inputs[index + 1].focus();
            });
        });
    </script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <% if (error) { %>
<script>
  Swal.fire({
    icon: 'error',
    title: 'Registration Error',
    text: '<%= error %>'
  });
</script>
<% } %>

<script>
  let time = 60; // seconds

  const timerEl = document.getElementById("timer");

  const interval = setInterval(() => {
    let minutes = Math.floor(time / 60);
    let seconds = time % 60;

    timerEl.textContent =
      `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

    time--;

    if (time < 0) {
      clearInterval(interval);
      timerEl.textContent = "Expired";
    }
  }, 1000);
</script>

<script>
  const btn = document.getElementById("verifyBtn");

  setTimeout(() => {
    btn.disabled = true;
    btn.innerText = "OTP Expired";
  }, 180000); 
</script>


</body>
</html>