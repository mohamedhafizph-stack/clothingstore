<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wearify Admin | User Management</title>
    <link rel="stylesheet" href="/css/usermanagment.css">
    <link rel="stylesheet" href="/css/adminDashboard.css">
    <%- include('../partials/sidebar', { activePage: 'users' }) %>
</head>
<body>

    <!-- <div class="sidebar">
        <h2>Wearify Admin</h2>
        <nav>
            <a href="/admin/dashboard" class="nav-item">Dashboard</a>
            <a href="#" class="nav-item">Orders</a>
            <a href="#" class="nav-item">Products</a>
            <a href="#" class="nav-item">Categories</a>
            <a href="/admin/users" class="nav-item active">Users</a>
            <a href="#" class="nav-item">Settings</a>
        </nav>
    </div> -->

    <div class="main-content">
        <header class="header">
            <div class="header-titles">
                <h1>User Management</h1>
                <p style="color: var(--text-secondary); margin: 0;">Manage your customers and staff</p>
            </div>
            
            <div class="header-profile">
                <span class="header-label">Admin Panel</span>
                <div class="profile-icon-container">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=6366f1&color=fff" alt="Profile">
                </div>
            </div>
        </header>

        <div class="user-controls">
           <form action="/admin/users" method="GET" class="search-wrapper">
  <input
    type="text"
    name="search"
    class="search-input"
    placeholder="Search users by name or email..."
    value="<%= search || '' %>"
  >

  <% if (search) { %>
    <a href="/admin/users" class="cancel-btn">âœ–</a>
  <% } %>
</form>

        </div>

        <div class="user-table-card">
            <table>
                <thead>
                    <tr>
                        <th>User</th>
                        <th>Email</th>
                       
                        <th>Status</th>
                        <th>Joined Date</th>
                        <th>Actions</th>
                        <th>Total orders</th>
                    </tr>
                </thead>
                <tbody>
                    <% users.forEach(user => { %>
                    <tr>
                 <td>
  <div class="user-info-cell">
    <% if (user.profilePic) { %>
      <img src="<%= user.profilePic %>" class="user-avatar" alt="User">
    <% } else { %>
      <img 
        src="https://ui-avatars.com/api/?name=<%= encodeURIComponent(user.name) %>&background=1c2e2a&color=fff"
        class="user-avatar"
        alt="Avatar"
      >
    <% } %>
    <span><%= user.name %></span>
  </div>
</td>

                        <td><%= user.email %></td>
                        <td>
                            <span class="status-badge <%= user.status === 'Active' ? 'status-active' : 'status-inactive' %>">
                                <%= user.status %>
                            </span>
                        </td>
                        <td><%= user.createdAt.toLocaleString() %></td>
                        <td>
  <% if (user.status === 'active') { %>
    <form action="/admin/users/block/<%= user._id %>" method="POST" style="display:inline;">
      <button class="action-btn block-btn">Block</button>
    </form>
  <% } else { %>
    <form action="/admin/users/unblock/<%= user._id %>" method="POST" style="display:inline;">
      <button class="action-btn unblock-btn">Unblock</button>
    </form>
  <% } %>
</td>
<td><%= count %></td>
                    </tr>
                    <% }) %>
                </tbody>
            </table>
            <div class="pagination">
  <% if (currentPage > 1) { %>
    <a href="?page=<%= currentPage - 1 %>&search=<%= search %>" class="page-btn">Prev</a>
  <% } %>

  <% for (let i = 1; i <= totalPages; i++) { %>
    <a
      href="?page=<%= i %>&search=<%= search %>"
      class="page-btn <%= i === currentPage ? 'active' : '' %>"
    >
      <%= i %>
    </a>
  <% } %>

  <% if (currentPage < totalPages) { %>
    <a href="?page=<%= currentPage + 1 %>&search=<%= search %>" class="page-btn">Next</a>
  <% } %>
</div>

        </div>
    </div>
</body>
</html>